{# @var craft \craft\web\twig\variables\CraftVariable #}
{#
/**
 * Guide plugin for Craft CMS 3.x
 *
 * Guide Settings.twig
 *
 * @author    TrendyMinds
 * @copyright Copyright (c) 2020 TrendyMinds
 * @link      https://trendyminds.com
 * @package   Guide
 * @since     1.0.0
 */
#}

{% import "_includes/forms" as forms %}

{% macro configWarning(setting, file) -%}
    {{ "This is being overridden by the {setting} config setting."|t({
        setting: '<a href="https://github.com/trendyminds/guide/blob/master/README.md#config-settings-'~setting~'" target="_blank">'~setting~'</a>'
    })|raw }}
{%- endmacro %}

{% from _self import configWarning %}

{% set configOverride = 'pluginNameOverride' in overrides %}
{{ forms.textField({
    label: "Plugin Name"|t,
    id: 'pluginNameOverride',
    name: 'pluginNameOverride',
    instructions: "Intuitive, human-readable plugin name for the end user."|t,
    value: settings.pluginNameOverride,
    autofocus: true,
    first: true,
    errors: '',
    warning: configOverride ? configWarning('pluginNameOverride'),
    disabled: configOverride,
    readonly: configOverride,
})}}

{% set configOverride = 'section' in overrides %}
{% set inputMacro = configOverride ? 'textField' : 'selectField' %}
{% set opts = {
    label: "User Manual Section"|t,
    id: 'section',
    name: 'section',
    instructions: 'Entries in this section cannot have URLs.'|t,
    value: settings.section,
    options: options,
    warning: configOverride ? configWarning('section'),
    disabled: configOverride,
    readonly: configOverride,
} %}
{{ configOverride ? forms.textField(opts) : forms.selectField(opts) }}

{% set instructions %}
For more control over the output, you may optionally override the default template.<br>
Path is relative to <code>{{ siteTemplatesPath }}</code>.
{% endset %}
{% set configOverride = 'templateOverride' in overrides %}

{{ forms.textField({
    label: "Template Override"|t,
    id: 'templateOverride',
    name: 'templateOverride',
    placeholder: '_includes/guideContent.twig',
    instructions: instructions|raw,
    value: settings.templateOverride,
    errors: '',
    warning: configOverride ? configWarning('templateOverride'),
    disabled: configOverride,
    readonly: configOverride,
})}}
